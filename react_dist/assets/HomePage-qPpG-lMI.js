import{j as e}from"./query-CLJXXnyt.js";import{a as s}from"./sentry-BmFBC7An.js";import{g as ue,t as P,f as xe}from"./arabic-utils-DbmNOh8M.js";import{c as he,M as V,L as D,I as pe,a as c,X as fe,B as N,C as be,H as z,u as ge,b as je,T as ye}from"./index-B7gfWGL-.js";import{S as ve}from"./search-B4UrYvuo.js";import{S as _,a as G,b as H,c as Q,d as S,M as Ne}from"./select-BBCGjmWg.js";import{M as K}from"./youtube-CY2NlXOD.js";import{N as we,u as ke}from"./use-geolocation-EesjWf3m.js";import"./checkbox-BKeUI-d9.js";import{u as Ce,a as Se,b as Le,c as Pe}from"./use-mosques-CHm49M2i.js";import"./firebase-app-B16QGRlq.js";import{M as Fe}from"./MosqueGrid-D-QyBb8k.js";import"./textarea-B5o91wq8.js";import{d as Me,L as Ee}from"./router-Di6JPJcB.js";import"./ui-vendor-Dbbq2re4.js";import"./AudioButton-DIHVMNWz.js";import"./circle-alert-CdOOUx3X.js";import"./share-2-C0CuHnV6.js";import"./external-link-B3dLlnZJ.js";import"./skeleton-wH4GlXrJ.js";const Ae=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],F=he("star",Ae);function Ie(t,r=500){const[a,i]=s.useState(t);return s.useEffect(()=>{const n=setTimeout(()=>{i(t)},r);return()=>{clearTimeout(n)}},[t,r]),a}function Re(){const t=ue();return e.jsxs("section",{className:"relative overflow-hidden bg-gradient-to-br from-primary to-primary-dark pb-10 pt-14 text-white md:pb-12 md:pt-20",children:[e.jsx("div",{className:"islamic-pattern-large absolute inset-0"}),e.jsx("div",{className:"pointer-events-none absolute inset-0 overflow-hidden opacity-[0.04]",children:e.jsxs("svg",{viewBox:"0 0 800 200",className:"absolute bottom-0 start-0 w-full",fill:"currentColor",children:[e.jsx("ellipse",{cx:"400",cy:"160",rx:"120",ry:"100"}),e.jsx("rect",{x:"220",y:"40",width:"20",height:"160"}),e.jsx("circle",{cx:"230",cy:"35",r:"14"}),e.jsx("rect",{x:"560",y:"40",width:"20",height:"160"}),e.jsx("circle",{cx:"570",cy:"35",r:"14"}),e.jsx("rect",{x:"260",y:"160",width:"280",height:"40"})]})}),e.jsx(F,{className:"pointer-events-none absolute top-6 start-[10%] h-3 w-3 text-white/10 md:h-4 md:w-4"}),e.jsx(F,{className:"pointer-events-none absolute top-10 end-[15%] h-2.5 w-2.5 text-white/[0.07]"}),e.jsx(F,{className:"pointer-events-none absolute bottom-16 start-[25%] h-2 w-2 text-white/[0.08]"}),e.jsxs("div",{className:"container relative z-10",children:[e.jsx("h2",{className:"hero-fade-in mb-4 text-2xl font-bold drop-shadow-[0_2px_4px_rgba(0,0,0,0.15)] md:text-3xl",children:"تصفح أشهر أئمة التراويح في الرياض"}),e.jsx("p",{className:"hero-fade-in animation-delay-150 max-w-2xl text-base leading-relaxed text-white/85 md:text-lg",children:"استمع لتلاوات الأئمة واختر المسجد الأقرب إليك لقضاء ليالي رمضان في خشوع وسكينة"}),t.type==="before"&&e.jsxs("div",{className:"hero-fade-in animation-delay-150 mt-5 inline-flex items-center gap-2.5 rounded-full border border-white/20 bg-white/10 px-5 py-2.5 text-sm backdrop-blur-sm md:text-base",children:[e.jsx(V,{className:"h-4 w-4 text-amber-300"}),e.jsxs("span",{children:["باقي ",e.jsx("strong",{className:"text-amber-200",children:P(t.daysUntil)})," يوم على بداية رمضان ١٤٤٧ هـ"]})]}),t.type==="during"&&e.jsxs("div",{className:"hero-fade-in animation-delay-150 mt-5 inline-flex items-center gap-2.5 rounded-full border border-white/20 bg-white/10 px-5 py-2.5 text-sm backdrop-blur-sm md:text-base",children:[e.jsx(V,{className:"h-4 w-4 text-amber-300"}),e.jsxs("span",{children:["الليلة ",e.jsx("strong",{className:"text-amber-200",children:P(t.nightNum)})," من رمضان — باقي ",P(t.daysLeft)," يوم"]})]})]})]})}function Te({value:t,onChange:r,isSearching:a=!1,placeholder:i="ابحث عن مسجد أو إمام..."}){const[n,d]=s.useState(t),[j,g]=s.useState(!1),o=s.useRef(null);s.useEffect(()=>{d(t)},[t]);const m=s.useCallback(x=>{const h=x.target.value;d(h),r(h)},[r]),y=s.useCallback(()=>{d(""),r(""),o.current?.focus()},[r]),u=s.useCallback(x=>{x.key==="Escape"&&y()},[y]);return e.jsxs("div",{className:c("group relative rounded-xl transition-shadow duration-300",j?"shadow-md":"shadow-sm"),children:[e.jsx("label",{htmlFor:"searchInput",className:"sr-only",children:"ابحث عن مسجد أو إمام"}),e.jsx("div",{className:"pointer-events-none absolute end-4 top-1/2 -translate-y-1/2 text-muted-foreground/50 transition-colors duration-200 group-focus-within:text-primary",children:a?e.jsx(D,{className:"h-5 w-5 animate-spin text-primary"}):e.jsx(ve,{className:"h-5 w-5",style:{transform:"none"}})}),e.jsx(pe,{ref:o,id:"searchInput",type:"text",value:n,onChange:m,onKeyDown:u,onFocus:()=>g(!0),onBlur:()=>g(!1),placeholder:i,autoComplete:"off",className:c("h-14 rounded-xl pe-12 ps-4 text-lg transition-all duration-300","border-border/60 bg-white","focus:border-primary focus:ring-2 focus:ring-primary/15","placeholder:text-muted-foreground/50 placeholder:text-base",a&&"border-primary/40",n&&"ps-11")}),e.jsx("div",{className:c("absolute start-3 top-1/2 -translate-y-1/2 transition-all duration-200",n?"scale-100 opacity-100":"pointer-events-none scale-75 opacity-0"),children:e.jsx("button",{type:"button",onClick:y,className:c("flex h-7 w-7 items-center justify-center rounded-full","text-muted-foreground transition-all duration-200","hover:bg-destructive/10 hover:text-destructive","active:scale-90"),"aria-label":"مسح البحث",tabIndex:n?0:-1,children:e.jsx(fe,{className:"h-4 w-4"})})})]})}function qe({value:t,onChange:r,areas:a,isLoading:i=!1}){return e.jsxs("div",{className:"relative",children:[e.jsx("label",{htmlFor:"areaFilter",className:"sr-only",children:"تصفية حسب المنطقة"}),e.jsxs(_,{value:t,onValueChange:r,disabled:i,children:[e.jsx(G,{id:"areaFilter",className:"h-14 rounded-xl border-border/60 bg-white text-base shadow-sm transition-all duration-300 hover:border-primary/40 focus:border-primary focus:ring-2 focus:ring-primary/15",children:e.jsx(H,{placeholder:"كل المناطق"})}),e.jsxs(Q,{className:"max-h-60",children:[e.jsx(S,{value:"الكل",children:"كل المناطق"}),a.map(n=>e.jsx(S,{value:n,children:n},n))]})]})]})}function Be({onClick:t,isLoading:r=!1,isActive:a=!1,isSuccess:i=!1,disabled:n=!1}){const d=()=>r?e.jsx(D,{className:"h-4 w-4 animate-spin"}):i?e.jsx(be,{className:"h-4 w-4"}):e.jsx(we,{className:"h-4 w-4"}),j=()=>r?"جاري تحديد موقعك...":i?"تم الترتيب حسب الأقرب":"الأقرب إليك";return e.jsxs(N,{variant:"outline",onClick:t,disabled:n||r,className:c("h-10 min-w-36 gap-2 rounded-full border border-primary/30 px-5 font-medium transition-all duration-200","hover:bg-primary/5 hover:border-primary/50","active:scale-[0.97]",a&&"border-primary bg-primary text-white hover:bg-primary-dark hover:border-primary-dark hover:text-white",i&&"border-accent bg-accent-light text-primary-dark"),children:[d(),e.jsx("span",{className:"button-text",children:j()})]})}function Ve({isOpen:t,onAllow:r,onDeny:a}){return t?e.jsx("div",{className:c("fixed inset-0 z-50 flex items-center justify-center bg-black/70 p-4 transition-all duration-300",t?"opacity-100":"pointer-events-none opacity-0"),onClick:a,children:e.jsxs("div",{className:"w-full max-w-md rounded-xl bg-white p-6 text-center shadow-xl",onClick:i=>i.stopPropagation(),children:[e.jsx("div",{className:"mb-5 text-5xl text-accent",children:e.jsx(K,{className:"mx-auto h-12 w-12"})}),e.jsx("h3",{className:"mb-4 text-xl font-bold text-primary",children:"السماح بتحديد موقعك"}),e.jsx("p",{className:"mb-6 leading-relaxed text-muted-foreground",children:"لعرض المساجد الأقرب إليك، نحتاج إلى إذن للوصول إلى موقعك الحالي. سيتم استخدام هذه المعلومات فقط لترتيب المساجد حسب المسافة."}),e.jsxs("div",{className:"flex justify-center gap-4",children:[e.jsx(N,{onClick:r,className:"min-w-24 rounded-full bg-primary px-6 hover:bg-primary-dark",children:"السماح"}),e.jsx(N,{variant:"secondary",onClick:a,className:"min-w-24 rounded-full bg-muted text-muted-foreground hover:bg-muted/80",children:"لاحقاً"})]})]})}):null}function De({onClick:t,isActive:r=!1,count:a,disabled:i=!1}){return e.jsxs(N,{variant:"outline",onClick:t,disabled:i||a===0,className:c("h-10 min-w-36 gap-2 rounded-full border border-primary/30 px-5 font-medium transition-all duration-200","hover:bg-primary/5 hover:border-primary/50","active:scale-[0.97]",r&&"border-primary bg-primary text-white hover:bg-primary-dark hover:border-primary-dark hover:text-white",a===0&&"opacity-50"),children:[e.jsx(z,{className:c("h-4 w-4",r&&"fill-current")}),e.jsxs("span",{children:["المفضلة",a>0&&e.jsx("span",{className:c("ms-1 inline-flex h-[18px] min-w-[18px] items-center justify-center rounded-full px-1 text-[10px] font-bold leading-none",r?"bg-white/20":"bg-primary/10 text-primary"),children:a})]})]})}function is(){const[t,r]=s.useState(""),[a,i]=s.useState("الكل"),[n,d]=s.useState("الكل"),[j,g]=s.useState(!1),[o,m]=s.useState(!1),[y,u]=s.useState(!1),[x,h]=s.useState(!1),O=Me(),M=Ie(t,500),{position:w,error:k,isLoading:E,isSupported:L,hasPermissionRequested:A,requestPosition:C,clearPosition:p}=ke(),{favoritesCount:U,isFavorite:X}=ge(),{data:J=[],isLoading:W}=Ce(),{data:Y=[]}=Se(a!=="الكل"?a:void 0),Z=s.useMemo(()=>({q:M,area:a,location:n}),[M,a,n]),$=s.useMemo(()=>w?{lat:w.latitude,lng:w.longitude}:null,[w]),{data:ee,isLoading:I,isError:se}=Le(Z,!o),{data:v,isLoading:te,isError:ae}=Pe($),R=o&&v?v:ee??[],f=x?R.filter(l=>X(l.id)):R,b=o?te||E:I,re=o?ae:se,ne=s.useCallback(l=>{r(l),m(!1),p(),u(!1),h(!1)},[p]),ie=s.useCallback(l=>{i(l),d("الكل"),m(!1),p(),u(!1),h(!1)},[p]),le=s.useCallback(l=>{d(l),m(!1),p(),u(!1),h(!1)},[p]),T=s.useCallback(()=>{r(""),i("الكل"),d("الكل"),m(!1),p(),u(!1),h(!1)},[p]),oe=s.useCallback(()=>{h(l=>!l)},[]),q=s.useCallback(()=>{if(L){if(!A){g(!0);return}C(),m(!0)}},[L,A,C]),ce=s.useCallback(()=>{g(!1),C(),m(!0)},[C]),de=s.useCallback(()=>{g(!1)},[]);s.useEffect(()=>{k&&(m(!1),u(!1))},[k]),s.useEffect(()=>{if(v&&v.length>0&&o){u(!0);const l=setTimeout(()=>u(!1),2e3);return()=>clearTimeout(l)}},[v,o]);const me=f.length,B=t||a!=="الكل"||n!=="الكل"||x;return e.jsxs(e.Fragment,{children:[e.jsx(Re,{}),e.jsxs("div",{className:"container relative z-10 -mt-5 mb-8",children:[e.jsxs("section",{className:"rounded-2xl bg-white p-5 shadow-card md:p-6",children:[e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row",children:[e.jsx("div",{className:"flex-1",children:e.jsx(Te,{value:t,onChange:ne,isSearching:I})}),e.jsx("div",{className:"md:w-56",children:e.jsx(qe,{value:a,onChange:ie,areas:J,isLoading:W})}),e.jsx("div",{className:"md:w-56",children:e.jsxs(_,{value:n,onValueChange:le,children:[e.jsxs(G,{className:"h-11 w-full gap-1.5 bg-white text-sm",children:[e.jsx(K,{className:"h-4 w-4 shrink-0 text-muted-foreground"}),e.jsx(H,{placeholder:"الأحياء"})]}),e.jsxs(Q,{children:[e.jsx(S,{value:"الكل",children:"الأحياء"}),Y.map(l=>e.jsx(S,{value:l,children:l},l))]})]})})]}),e.jsx("div",{className:"my-4 border-t border-border/30"}),e.jsxs("div",{className:"flex flex-wrap justify-center gap-3",children:[e.jsx(Be,{onClick:q,isLoading:E,isActive:o,isSuccess:y,disabled:!L}),e.jsx(De,{onClick:oe,isActive:x,count:U}),e.jsxs(N,{variant:"outline",size:"sm",onClick:()=>O("/map"),className:"h-10 gap-1.5 rounded-full border-border/60 px-4 text-sm font-medium",children:[e.jsx(Ne,{className:"h-4 w-4"}),"خريطة"]})]})]}),(B||o)&&!b&&e.jsxs("div",{className:"mt-4 flex items-center justify-between text-sm text-muted-foreground",children:[e.jsxs("p",{children:["تم العثور على ",me," مسجد"]}),(B||o)&&e.jsx("button",{onClick:T,className:"rounded-full px-3 py-1 text-sm font-medium text-primary transition-all duration-200 hover:bg-primary-light active:scale-95",children:"مسح البحث ✕"})]}),o&&!b&&f.length>0&&e.jsxs("div",{className:c("mt-2 flex items-center gap-2 text-sm text-muted-foreground","rounded-lg bg-primary-light/50 px-3 py-2"),children:[e.jsx(je,{className:"h-4 w-4 text-primary"}),e.jsx("span",{children:"تم ترتيب المساجد حسب الأقرب إليك"})]}),x&&!b&&e.jsxs("div",{className:c("mt-2 flex items-center gap-2 text-sm text-muted-foreground","rounded-lg bg-accent-light/50 px-3 py-2"),children:[e.jsx(z,{className:"h-4 w-4 fill-accent text-accent"}),e.jsxs("span",{children:["عرض المساجد المفضلة فقط (",f.length,")"]})]}),k&&e.jsxs("div",{className:"mt-4 rounded-lg bg-destructive/10 px-4 py-3 text-sm text-destructive",children:[k.message,e.jsx("button",{onClick:q,className:"me-2 underline hover:no-underline",children:"إعادة المحاولة"})]})]}),e.jsxs("div",{className:"container mb-12",children:[e.jsx(Fe,{mosques:f,isLoading:b,isError:re,isEmpty:f.length===0&&!b,onReset:T,isProximitySorted:o}),!b&&f.length>0&&e.jsx("div",{className:"mt-8 border-t border-dashed border-border pt-4 text-center",children:e.jsxs("p",{className:"text-sm text-muted-foreground",children:["آخر تحديث: ",e.jsx("span",{id:"mainPageLastUpdate",children:xe()})]})}),!b&&f.length>0&&e.jsxs("div",{className:"mt-4 flex items-center justify-center gap-2 rounded-lg bg-amber-50 px-4 py-3 text-sm text-amber-800",children:[e.jsx(ye,{className:"h-4 w-4 shrink-0 text-amber-500"}),e.jsxs("span",{children:["هذا الموقع جهد شخصي غير رسمي، وفي حال وجود أي تحديثات أو ملاحظات نسعد بتواصلكم معنا"," ",e.jsx(Ee,{to:"/contact",className:"font-medium underline hover:no-underline",children:"تواصل معنا"})]})]})]}),e.jsx(Ve,{isOpen:j,onAllow:ce,onDeny:de})]})}export{is as HomePage};

import{j as d}from"./query-CLJXXnyt.js";import{B as K,X as ie,q as ae,n as le,A as ce}from"./index-B7gfWGL-.js";import{g as ue,a as l,b as E}from"./sentry-BmFBC7An.js";import{r as G,L as de}from"./router-Di6JPJcB.js";import{A as fe}from"./AudioButton-DIHVMNWz.js";import"./firebase-app-B16QGRlq.js";import{N as me,u as ge}from"./use-geolocation-EesjWf3m.js";import{E as pe}from"./external-link-B3dLlnZJ.js";import{e as he}from"./use-mosques-CHm49M2i.js";import"./ui-vendor-Dbbq2re4.js";import"./circle-alert-CdOOUx3X.js";var B,V;function ve(){return V||(V=1,B=function t(e,n){if(e===n)return!0;if(e&&n&&typeof e=="object"&&typeof n=="object"){if(e.constructor!==n.constructor)return!1;var o,r,s;if(Array.isArray(e)){if(o=e.length,o!=n.length)return!1;for(r=o;r--!==0;)if(!t(e[r],n[r]))return!1;return!0}if(e.constructor===RegExp)return e.source===n.source&&e.flags===n.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===n.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===n.toString();if(s=Object.keys(e),o=s.length,o!==Object.keys(n).length)return!1;for(r=o;r--!==0;)if(!Object.prototype.hasOwnProperty.call(n,s[r]))return!1;for(r=o;r--!==0;){var i=s[r];if(!t(e[i],n[i]))return!1}return!0}return e!==e&&n!==n}),B}var be=ve();const Y=ue(be),ye="1.7.1";function _(t,e){var n={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.indexOf(o)<0&&(n[o]=t[o]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,o=Object.getOwnPropertySymbols(t);r<o.length;r++)e.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(t,o[r])&&(n[o[r]]=t[o[r]]);return n}function H(t,e,n,o){function r(s){return s instanceof n?s:new n(function(i){i(s)})}return new(n||(n=Promise))(function(s,i){function a(u){try{m(o.next(u))}catch(p){i(p)}}function f(u){try{m(o.throw(u))}catch(p){i(p)}}function m(u){u.done?s(u.value):r(u.value).then(a,f)}m((o=o.apply(t,[])).next())})}const k={NOT_LOADED:"NOT_LOADED",LOADING:"LOADING",LOADED:"LOADED",FAILED:"FAILED",AUTH_FAILURE:"AUTH_FAILURE"},xe="https://maps.googleapis.com/maps/api/js";class z{static load(e,n){return H(this,void 0,void 0,function*(){var o,r;const s=e.libraries?e.libraries.split(","):[],i=this.serializeParams(e);this.listeners.push(n),!((r=(o=window.google)===null||o===void 0?void 0:o.maps)===null||r===void 0)&&r.importLibrary?(this.serializedApiParams||(this.loadingStatus=k.LOADED),this.notifyLoadingStatusListeners()):(this.serializedApiParams=i,this.initImportLibrary(e)),this.serializedApiParams&&this.serializedApiParams!==i&&console.warn("[google-maps-api-loader] The maps API has already been loaded with different parameters and will not be loaded again. Refresh the page for new values to have effect.");const a=["maps",...s];yield Promise.all(a.map(f=>google.maps.importLibrary(f)))})}static serializeParams(e){return[e.v,e.key,e.language,e.region,e.authReferrerPolicy,e.solutionChannel].join("/")}static initImportLibrary(e){if(window.google||(window.google={}),window.google.maps||(window.google.maps={}),window.google.maps.importLibrary){console.error("[google-maps-api-loader-internal]: initImportLibrary must only be called once");return}let n=null;const o=()=>n||(n=new Promise((r,s)=>{var i;const a=document.createElement("script"),f=new URLSearchParams;for(const[m,u]of Object.entries(e)){const p=m.replace(/[A-Z]/g,g=>"_"+g[0].toLowerCase());f.set(p,String(u))}f.set("loading","async"),f.set("callback","__googleMapsCallback__"),a.async=!0,a.src=xe+"?"+f.toString(),a.nonce=((i=document.querySelector("script[nonce]"))===null||i===void 0?void 0:i.nonce)||"",a.onerror=()=>{this.loadingStatus=k.FAILED,this.notifyLoadingStatusListeners(),s(new Error("The Google Maps JavaScript API could not load."))},window.__googleMapsCallback__=()=>{this.loadingStatus=k.LOADED,this.notifyLoadingStatusListeners(),r()},window.gm_authFailure=()=>{this.loadingStatus=k.AUTH_FAILURE,this.notifyLoadingStatusListeners()},this.loadingStatus=k.LOADING,this.notifyLoadingStatusListeners(),document.head.append(a)}),n);google.maps.importLibrary=r=>o().then(()=>google.maps.importLibrary(r))}static notifyLoadingStatusListeners(){for(const e of this.listeners)e(this.loadingStatus)}}z.loadingStatus=k.NOT_LOADED;z.listeners=[];const Ee="GMP_visgl_rgmlibrary_v1_default",Ce=[`gmp_visgl_reactgooglemaps_v${ye}`],D=E.createContext(null);function we(){const[t,e]=l.useState({});return{mapInstances:t,addMapInstance:(s,i="default")=>{e(a=>Object.assign(Object.assign({},a),{[i]:s}))},removeMapInstance:(s="default")=>{e(i=>{var a=s;i[a];var f=_(i,[typeof a=="symbol"?a:a+""]);return f})},clearMapInstances:()=>{e({})}}}function Oe(t){const{onLoad:e,onError:n,apiKey:o,version:r,libraries:s=[]}=t,i=_(t,["onLoad","onError","apiKey","version","libraries"]),[a,f]=l.useState(z.loadingStatus),[m,u]=l.useReducer((c,v)=>c[v.name]?c:Object.assign(Object.assign({},c),{[v.name]:v.value}),{}),p=l.useMemo(()=>s?.join(","),[s]),g=l.useMemo(()=>JSON.stringify(Object.assign({apiKey:o,version:r},i)),[o,r,i]),h=l.useCallback(c=>H(this,void 0,void 0,function*(){var v;if(m[c])return m[c];if(!(!((v=google==null?void 0:google.maps)===null||v===void 0)&&v.importLibrary))throw new Error("[api-provider-internal] importLibrary was called before google.maps.importLibrary was defined.");const x=yield window.google.maps.importLibrary(c);return u({name:c,value:x}),x}),[m]);return l.useEffect(()=>{H(this,void 0,void 0,function*(){try{const c=Object.assign({key:o},i);r&&(c.v=r),p?.length>0&&(c.libraries=p),(c.channel===void 0||c.channel<0||c.channel>999)&&delete c.channel,c.solutionChannel===void 0?c.solutionChannel=Ee:c.solutionChannel===""&&delete c.solutionChannel,yield z.load(c,v=>f(v));for(const v of["core","maps",...s])yield h(v);e&&e()}catch(c){n?n(c):console.error("<ApiProvider> failed to load the Google Maps JavaScript API",c)}})},[o,p,g]),{status:a,loadedLibraries:m,importLibrary:h}}function Le(t){return l.useMemo(()=>t.disableUsageAttribution?null:Ce,[t.disableUsageAttribution])}const Me=t=>{const{children:e}=t,n=_(t,["children"]),{mapInstances:o,addMapInstance:r,removeMapInstance:s,clearMapInstances:i}=we(),{status:a,loadedLibraries:f,importLibrary:m}=Oe(n),u=Le(n),p=l.useMemo(()=>({mapInstances:o,addMapInstance:r,removeMapInstance:s,clearMapInstances:i,status:a,loadedLibraries:f,importLibrary:m,internalUsageAttributionIds:u}),[o,r,s,i,a,f,m,u]);return E.createElement(D.Provider,{value:p},e)};function Ie(t,e){for(const n of Ne){const o=e[n],r=X[n];l.useEffect(()=>{if(!t||!o)return;const s=google.maps.event.addListener(t,r,i=>{o(Ae(r,t,i))});return()=>s.remove()},[t,r,o])}}function Ae(t,e,n){var o;const r={type:t,map:e,detail:{},stoppable:!1,stop:()=>{}};if(Se.includes(t)){const s=r,i=e.getCenter(),a=e.getZoom(),f=e.getHeading()||0,m=e.getTilt()||0,u=e.getBounds();return(!i||!u||!Number.isFinite(a))&&console.warn("[createEvent] at least one of the values from the map returned undefined. This is not expected to happen. Please report an issue at https://github.com/visgl/react-google-maps/issues/new"),s.detail={center:i?.toJSON()||{lat:0,lng:0},zoom:a||0,heading:f,tilt:m,bounds:u?.toJSON()||{north:90,east:180,south:-90,west:-180}},s}else if(ke.includes(t)){if(!n)throw new Error("[createEvent] mouse events must provide a srcEvent");const s=r;return s.domEvent=n.domEvent,s.stoppable=!0,s.stop=()=>n.stop(),s.detail={latLng:((o=n.latLng)===null||o===void 0?void 0:o.toJSON())||null,placeId:n.placeId},s}return r}const X={onBoundsChanged:"bounds_changed",onCenterChanged:"center_changed",onClick:"click",onContextmenu:"contextmenu",onDblclick:"dblclick",onDrag:"drag",onDragend:"dragend",onDragstart:"dragstart",onHeadingChanged:"heading_changed",onIdle:"idle",onIsFractionalZoomEnabledChanged:"isfractionalzoomenabled_changed",onMapCapabilitiesChanged:"mapcapabilities_changed",onMapTypeIdChanged:"maptypeid_changed",onMousemove:"mousemove",onMouseout:"mouseout",onMouseover:"mouseover",onProjectionChanged:"projection_changed",onRenderingTypeChanged:"renderingtype_changed",onTilesLoaded:"tilesloaded",onTiltChanged:"tilt_changed",onZoomChanged:"zoom_changed",onCameraChanged:"bounds_changed"},Se=["bounds_changed","center_changed","heading_changed","tilt_changed","zoom_changed"],ke=["click","contextmenu","dblclick","mousemove","mouseout","mouseover"],Ne=Object.keys(X);function _e(t){const e=l.useRef(void 0);return l.useEffect(()=>{e.current=t}),e.current}function Q(t,e){const n=_e(t);return l.useMemo(()=>n&&e(n,t)?n:t,[t,n,e])}function je(t,e,n){l.useEffect(t,[Q(e,n)])}function De(t,e){je(t,e,Y)}const Te=new Set(["backgroundColor","clickableIcons","controlSize","disableDefaultUI","disableDoubleClickZoom","draggable","draggableCursor","draggingCursor","fullscreenControl","fullscreenControlOptions","gestureHandling","headingInteractionEnabled","isFractionalZoomEnabled","keyboardShortcuts","mapTypeControl","mapTypeControlOptions","mapTypeId","maxZoom","minZoom","noClear","panControl","panControlOptions","restriction","rotateControl","rotateControlOptions","scaleControl","scaleControlOptions","scrollwheel","streetView","streetViewControl","streetViewControlOptions","styles","tiltInteractionEnabled","zoomControl","zoomControlOptions"]);function Pe(t,e){const n={},o=Object.keys(e);for(const r of o)Te.has(r)&&(n[r]=e[r]);De(()=>{t&&t.setOptions(n)},[n])}function ee(){var t;return((t=l.useContext(D))===null||t===void 0?void 0:t.status)||k.NOT_LOADED}function ze(t,e){const{viewport:n,viewState:o}=e,r=!!n;return l.useLayoutEffect(()=>{if(!t||!o)return;const{latitude:s,longitude:i,bearing:a,pitch:f,zoom:m}=o;t.moveCamera({center:{lat:s,lng:i},heading:a,tilt:f,zoom:m+1})},[t,o]),r}function Fe(t){return!t||typeof t!="object"||!("lat"in t&&"lng"in t)?!1:Number.isFinite(t.lat)&&Number.isFinite(t.lng)}function te(t){return Fe(t)?t:t.toJSON()}function Re(t,e,n){const o=n.center?te(n.center):null;let r=null,s=null;o&&Number.isFinite(o.lat)&&Number.isFinite(o.lng)&&(r=o.lat,s=o.lng);const i=Number.isFinite(n.zoom)?n.zoom:null,a=Number.isFinite(n.heading)?n.heading:null,f=Number.isFinite(n.tilt)?n.tilt:null;l.useLayoutEffect(()=>{if(!t)return;const m={};let u=!1;r!==null&&s!==null&&(e.current.center.lat!==r||e.current.center.lng!==s)&&(m.center={lat:r,lng:s},u=!0),i!==null&&e.current.zoom!==i&&(m.zoom=i,u=!0),a!==null&&e.current.heading!==a&&(m.heading=a,u=!0),f!==null&&e.current.tilt!==f&&(m.tilt=f,u=!0),u&&t.moveCamera(m)})}const Ue=()=>{const t={position:"absolute",top:0,left:0,bottom:0,right:0,zIndex:999,display:"flex",flexFlow:"column nowrap",textAlign:"center",justifyContent:"center",fontSize:".8rem",color:"rgba(0,0,0,0.6)",background:"#dddddd",padding:"1rem 1.5rem"};return E.createElement("div",{style:t},E.createElement("h2",null,"Error: AuthFailure"),E.createElement("p",null,"A problem with your API key prevents the map from rendering correctly. Please make sure the value of the ",E.createElement("code",null,"APIProvider.apiKey")," prop is correct. Check the error-message in the console for further details."))};function Be(){const[t,e]=l.useState(null),n=l.useCallback(o=>e(o),[e]);return[t,n]}function ne(){return ee()===k.LOADED}function Ge(){const[,t]=l.useReducer(e=>e+1,0);return t}function He(t,e){const n=t.getCenter(),o=t.getZoom(),r=t.getHeading()||0,s=t.getTilt()||0,i=t.getBounds();(!n||!i||!Number.isFinite(o))&&console.warn("[useTrackedCameraState] at least one of the values from the map returned undefined. This is not expected to happen. Please report an issue at https://github.com/visgl/react-google-maps/issues/new"),Object.assign(e.current,{center:n?.toJSON()||{lat:0,lng:0},zoom:o||0,heading:r,tilt:s})}function qe(t){const e=Ge(),n=l.useRef({center:{lat:0,lng:0},heading:0,tilt:0,zoom:0});return l.useEffect(()=>{if(!t)return;const o=google.maps.event.addListener(t,"bounds_changed",()=>{He(t,n),e()});return()=>o.remove()},[t,e]),n}class P{static has(e){return this.entries[e]&&this.entries[e].length>0}static pop(e){return this.entries[e]&&this.entries[e].pop()||null}static push(e,n){this.entries[e]||(this.entries[e]=[]),this.entries[e].push(n)}}P.entries={};function Ze(t,e){const n=ne(),[o,r]=l.useState(null),[s,i]=Be(),a=qe(o),{id:f,defaultBounds:m,defaultCenter:u,defaultZoom:p,defaultHeading:g,defaultTilt:h,reuseMaps:c,renderingType:v,colorScheme:x}=t,b=_(t,["id","defaultBounds","defaultCenter","defaultZoom","defaultHeading","defaultTilt","reuseMaps","renderingType","colorScheme"]),L=t.zoom!==void 0||t.defaultZoom!==void 0,y=t.center!==void 0||t.defaultCenter!==void 0;!m&&(!L||!y)&&console.warn("<Map> component is missing configuration. You have to provide zoom and center (via the `zoom`/`defaultZoom` and `center`/`defaultCenter` props) or specify the region to show using `defaultBounds`. See https://visgl.github.io/react-google-maps/docs/api-reference/components/map#required"),!b.center&&u&&(b.center=u),!b.zoom&&Number.isFinite(p)&&(b.zoom=p),!b.heading&&Number.isFinite(g)&&(b.heading=g),!b.tilt&&Number.isFinite(h)&&(b.tilt=h);const M=b.internalUsageAttributionIds;M==null?b.internalUsageAttributionIds=e.internalUsageAttributionIds:b.internalUsageAttributionIds=[...e.internalUsageAttributionIds||[],...M];for(const O of Object.keys(b))b[O]===void 0&&delete b[O];const A=l.useRef(void 0);return l.useEffect(()=>{if(!s||!n)return;const{addMapInstance:O,removeMapInstance:N}=e,{mapId:S}=t,I=`${S||"default"}:${v||"default"}:${x||"LIGHT"}`;let C,w;if(c&&P.has(I)?(w=P.pop(I),C=w.getDiv(),s.appendChild(C),w.setOptions(b),setTimeout(()=>w.setCenter(w.getCenter()),0)):(C=document.createElement("div"),C.style.height="100%",s.appendChild(C),w=new google.maps.Map(C,Object.assign(Object.assign(Object.assign({},b),v?{renderingType:v}:{}),x?{colorScheme:x}:{}))),r(w),O(w,f),m){const{padding:R}=m,U=_(m,["padding"]);w.fitBounds(U,R)}else(!L||!y)&&w.fitBounds({east:180,west:-180,south:-90,north:90});if(A.current){const{mapId:R,cameraState:U}=A.current;R!==S&&w.setOptions(U)}return()=>{A.current={mapId:S,cameraState:a.current},C.remove(),c?P.push(I,w):google.maps.event.clearInstanceListeners(w),r(null),N(f)}},[s,n,f,t.mapId,t.renderingType,t.colorScheme]),[o,i,a]}const oe=E.createContext(null),re=t=>{const{children:e,id:n,className:o,style:r}=t,s=l.useContext(D),i=ee();if(!s)throw new Error("<Map> can only be used inside an <ApiProvider> component.");const[a,f,m]=Ze(t,s);Re(a,m,t),Ie(a,t),Pe(a,t);const u=ze(a,t),p=!!t.controlled;l.useEffect(()=>{if(a)return u&&a.setOptions({disableDefaultUI:!0}),(u||p)&&a.setOptions({gestureHandling:"none",keyboardShortcuts:!1}),()=>{a.setOptions({gestureHandling:t.gestureHandling,keyboardShortcuts:t.keyboardShortcuts})}},[a,u,p,t.gestureHandling,t.keyboardShortcuts]);const g=t.center?te(t.center):null;let h=null,c=null;g&&Number.isFinite(g.lat)&&Number.isFinite(g.lng)&&(h=g.lat,c=g.lng);const v=l.useMemo(()=>{var L,y,M;return{center:{lat:h??0,lng:c??0},zoom:(L=t.zoom)!==null&&L!==void 0?L:0,heading:(y=t.heading)!==null&&y!==void 0?y:0,tilt:(M=t.tilt)!==null&&M!==void 0?M:0}},[h,c,t.zoom,t.heading,t.tilt]);l.useLayoutEffect(()=>{if(!a||!p)return;a.moveCamera(v);const L=a.addListener("bounds_changed",()=>{a.moveCamera(v)});return()=>L.remove()},[a,p,v]);const x=l.useMemo(()=>Object.assign({width:"100%",height:"100%",position:"relative",zIndex:u?-1:0},r),[r,u]),b=l.useMemo(()=>({map:a}),[a]);return i===k.AUTH_FAILURE?E.createElement("div",{style:Object.assign({position:"relative"},o?{}:x),className:o},E.createElement(Ue,null)):E.createElement("div",Object.assign({ref:f,"data-testid":"map",style:o?void 0:x,className:o},n?{id:n}:{}),a?E.createElement(oe.Provider,{value:b},e):null)};re.deckGLViewProps=!0;const W=new Set;function Ve(...t){const e=JSON.stringify(t);W.has(e)||(W.add(e),console.error(...t))}const F=(t=null)=>{const e=l.useContext(D),{map:n}=l.useContext(oe)||{};if(e===null)return Ve("useMap(): failed to retrieve APIProviderContext. Make sure that the <APIProvider> component exists and that the component you are calling `useMap()` from is a sibling of the <APIProvider>."),null;const{mapInstances:o}=e;return t!==null?o[t]||null:n||o.default||null};function se(t){const e=ne(),n=l.useContext(D);return l.useEffect(()=>{!e||!n||n.importLibrary(t)},[e,n,t]),n?.loadedLibraries[t]||null}function j(t,e,n){l.useEffect(()=>{if(!t||!e||!n)return;const o=google.maps.event.addListener(t,e,n);return()=>o.remove()},[t,e,n])}function T(t,e,n){l.useEffect(()=>{t&&(t[e]=n)},[t,e,n])}function J(t,e,n){l.useEffect(()=>{if(!(!t||!e||!n))return t.addEventListener(e,n),()=>t.removeEventListener(e,n)},[t,e,n])}class We{constructor(){this.renderedStyles=new Set,this.styleElement=null}getStyleElement(){return this.styleElement||(this.styleElement=document.createElement("style"),this.styleElement.setAttribute("data-rgm-anchor-styles",""),document.head.appendChild(this.styleElement)),this.styleElement}addAdvancedMarkerPointerEventsOverwrite(){if(this.renderedStyles.has("marker-pointer-events"))return;const e=this.getStyleElement();e.textContent+=`
      gmp-advanced-marker[data-origin='rgm'] {
        pointer-events: none !important;
      }
    `,this.renderedStyles.add("marker-pointer-events")}cleanup(){this.styleElement&&(this.styleElement.remove(),this.styleElement=null,this.renderedStyles.clear())}}const Je=new We;function $e(t,e){var n;if(!(!((n=google==null?void 0:google.maps)===null||n===void 0)&&n.version))return;const o=google.maps.version.split("."),r=parseInt(o[0],10),s=parseInt(o[1],10);return r>t||r===t&&s>=e}const Ke=E.createContext(null),Ye={BOTTOM:["50%","100%"]},q=l.forwardRef((t,e)=>{const{children:n,style:o,className:r,anchorPoint:s}=t,[i,a]=et(t),f=l.useMemo(()=>i?{marker:i}:null,[i]);return l.useImperativeHandle(e,()=>i,[i]),a?E.createElement(Ke.Provider,{value:f},G.createPortal(E.createElement(Qe,{anchorPoint:s,styles:o,className:r},n),a)):null});q.displayName="AdvancedMarker";function Xe(t){return t.content!==void 0}function Z(t){return t.nodeType===Node.ELEMENT_NODE}const Qe=({children:t,styles:e,className:n})=>E.createElement("div",{className:n,style:e},t);function et(t){const[e,n]=l.useState(null),[o,r]=l.useState(null),s=F(),i=se("marker"),{children:a,onClick:f,className:m,onMouseEnter:u,onMouseLeave:p,onDrag:g,onDragStart:h,onDragEnd:c,collisionBehavior:v,clickable:x,draggable:b,position:L,title:y,zIndex:M,anchorPoint:A,anchorLeft:O,anchorTop:N}=t,S=l.Children.count(a);return l.useEffect(()=>{if(!s||!i)return;const I=new i.AdvancedMarkerElement;I.map=s,n(I);let C=null;return S>0&&(C=document.createElement("div"),I.content=C,r(C)),()=>{I.map=null,C?.remove(),n(null),r(null)}},[s,i,S]),l.useEffect(()=>{!e?.content||!Z(e.content)||S>0||(e.content.className=m??"")},[e,m,S]),tt(e,A,O,N,S>0),T(e,"position",L),T(e,"title",y??""),T(e,"zIndex",M),T(e,"collisionBehavior",v),l.useEffect(()=>{e&&(b!==void 0?e.gmpDraggable=b:g||h||c?e.gmpDraggable=!0:e.gmpDraggable=!1)},[e,b,g,c,h]),l.useEffect(()=>{if(!e)return;const I=x!==void 0||!!f||!!u||!!p;e.gmpClickable=I,I&&e?.content&&Z(e.content)&&(e.content.style.pointerEvents="all",f&&(e.content.style.cursor="pointer"))},[e,x,f,u,p]),j(e,"click",f),j(e,"drag",g),j(e,"dragstart",h),j(e,"dragend",c),J(e?.element,"mouseenter",u),J(e?.element,"mouseleave",p),[e,o]}function tt(t,e,n,o,r){l.useEffect(()=>{if(!t||!r)return;const s=$e(3,62),i=t.content;if(!(!i||!Z(i))){if(n!==void 0||o!==void 0){s||console.warn(`AdvancedMarker: The anchorLeft and anchorTop props are only supported in Google Maps API version 3.62 and above. The current version is ${google.maps.version}.`),t.anchorLeft=n,t.anchorTop=o,e!==void 0&&console.warn("AdvancedMarker: the anchorPoint prop is ignored when anchorLeft and/or anchorTop are set.");return}if(e!==void 0){const[a,f]=e??Ye.BOTTOM,m=`calc(-1 * ${a})`,u=`calc(-1 * ${f})`;s?(t.anchorLeft=m,t.anchorTop=u,i.style.transform=""):(i.style.transform=`translate(50%, 100%) translate(${m}, ${u})`,t.dataset.origin="rgm",Je.addAdvancedMarkerPointerEventsOverwrite())}}},[t,e,n,o,r])}function nt(t,e,n){if(e!=null&&typeof e!="object")throw new Error("The `style` prop expects a mapping from style properties to values, not a string. For example, style={{marginRight: spacing + 'em'}} when using JSX.");const o=t.style;if(n==null){if(e==null)return;for(const r in e)e.hasOwnProperty(r)&&$(o,r,e[r]);return}for(const r in n)n.hasOwnProperty(r)&&(e==null||!e.hasOwnProperty(r))&&(r.indexOf("--")===0?o.setProperty(r,""):r==="float"?o.cssFloat="":o[r]="");if(e!=null)for(const r in e){const s=e[r];e.hasOwnProperty(r)&&n[r]!==s&&$(o,r,s)}}function $(t,e,n){const o=e.indexOf("--")===0;n==null||typeof n=="boolean"||n===""?o?t.setProperty(e,""):e==="float"?t.cssFloat="":t[e]="":o?t.setProperty(e,n):typeof n=="number"&&n!==0&&!rt(e)?t[e]=n+"px":e==="float"?t.cssFloat=n:t[e]=(""+n).trim()}const ot=new Set(["animationIterationCount","aspectRatio","borderImageOutset","borderImageSlice","borderImageWidth","boxFlex","boxFlexGroup","boxOrdinalGroup","columnCount","columns","flex","flexGrow","flexPositive","flexShrink","flexNegative","flexOrder","gridArea","gridRow","gridRowEnd","gridRowSpan","gridRowStart","gridColumn","gridColumnEnd","gridColumnSpan","gridColumnStart","fontWeight","lineClamp","lineHeight","opacity","order","orphans","scale","tabSize","widows","zIndex","zoom","fillOpacity","floodOpacity","stopOpacity","strokeDasharray","strokeDashoffset","strokeMiterlimit","strokeOpacity","strokeWidth"]);function rt(t){return ot.has(t)}const st=t=>{const{children:e,headerContent:n,style:o,className:r,pixelOffset:s,anchor:i,shouldFocus:a,onClose:f,onCloseClick:m}=t,u=_(t,["children","headerContent","style","className","pixelOffset","anchor","shouldFocus","onClose","onCloseClick"]),p=se("maps"),[g,h]=l.useState(null),c=l.useRef(null),v=l.useRef(null),x=Q(u,Y);l.useEffect(()=>{if(!p)return;c.current=document.createElement("div"),v.current=document.createElement("div");const y=x;s&&(y.pixelOffset=new google.maps.Size(s[0],s[1])),n&&(y.headerContent=typeof n=="string"?n:v.current);const M=new google.maps.InfoWindow(x);return M.setContent(c.current),h(M),()=>{var A,O;M.setContent(null),(A=c.current)===null||A===void 0||A.remove(),(O=v.current)===null||O===void 0||O.remove(),c.current=null,v.current=null,h(null)}},[p]);const b=l.useRef(null);l.useEffect(()=>{!g||!c.current||(nt(c.current,o||null,b.current),b.current=o||null,r!==c.current.className&&(c.current.className=r||""))},[g,r,o]),l.useEffect(()=>{if(!g)return;const y=x;s?y.pixelOffset=new google.maps.Size(s[0],s[1]):y.pixelOffset=null,n?y.headerContent=typeof n=="string"?n:v.current:y.headerContent=null,g.setOptions(x)},[x,s,n]),j(g,"close",f),j(g,"closeclick",m);const L=F();return l.useEffect(()=>{var y;if(!L||!g||i===null)return;const M=!!i,A={map:L};if(i&&(A.anchor=i,Xe(i)&&i.content instanceof Element)){const O=i?.getBoundingClientRect();if(O&&i.dataset.origin==="rgm"){const N=(y=i.content.firstElementChild)===null||y===void 0?void 0:y.firstElementChild,S=N?.getBoundingClientRect(),I=S.x-O.x+(S.width-O.width)/2,C=S.y-O.y,w=x;w.pixelOffset=new google.maps.Size(s?s[0]+I:I,s?s[1]+C:C),g.setOptions(w)}}return a!==void 0&&(A.shouldFocus=a),g.open(A),()=>{M&&g.set("anchor",null),g.close()}},[g,i,L,a,x,s]),E.createElement(E.Fragment,null,c.current&&G.createPortal(e,c.current),v.current!==null&&G.createPortal(n,v.current))};function it(t){const[e,n]=l.useState(null),o=F(),{onClick:r,onDrag:s,onDragStart:i,onDragEnd:a,onMouseOver:f,onMouseOut:m}=t,u=_(t,["onClick","onDrag","onDragStart","onDragEnd","onMouseOver","onMouseOut"]),{position:p,draggable:g}=u;return l.useEffect(()=>{if(!o){o===void 0&&console.error("<Marker> has to be inside a Map component.");return}const h=new google.maps.Marker(u);return h.setMap(o),n(h),()=>{h.setMap(null),n(null)}},[o]),l.useEffect(()=>{if(!e)return;const h=e,c=google.maps.event;return r&&c.addListener(h,"click",r),s&&c.addListener(h,"drag",s),i&&c.addListener(h,"dragstart",i),a&&c.addListener(h,"dragend",a),f&&c.addListener(h,"mouseover",f),m&&c.addListener(h,"mouseout",m),e.setDraggable(!!g),()=>{c.clearInstanceListeners(h)}},[e,g,r,s,i,a,f,m]),l.useEffect(()=>{e&&u&&e.setOptions(u)},[e,u]),l.useEffect(()=>{g||!p||!e||e.setPosition(p)},[g,p,e]),e}const at=l.forwardRef((t,e)=>{const n=it(t);return l.useImperativeHandle(e,()=>n,[n]),E.createElement(E.Fragment,null)});at.displayName="Marker";const lt="AIzaSyAm34gMUduWSAno9CAk70lwcEt6RBEkuGI",ct={lat:24.7136,lng:46.6753};function ut({mosques:t,userPosition:e}){const[n,o]=l.useState(null);return d.jsxs(d.Fragment,{children:[e&&d.jsx(q,{position:{lat:e.latitude,lng:e.longitude},zIndex:1e3,children:d.jsxs("div",{className:"relative flex items-center justify-center",children:[d.jsx("div",{className:"absolute h-8 w-8 animate-ping rounded-full bg-blue-400/30"}),d.jsx("div",{className:"h-4 w-4 rounded-full border-2 border-white bg-blue-500 shadow-lg"})]})}),t.map(r=>!r.latitude||!r.longitude?null:d.jsx(q,{position:{lat:r.latitude,lng:r.longitude},onClick:()=>o(r),children:d.jsx("div",{className:"flex h-9 w-9 items-center justify-center rounded-full bg-primary text-white shadow-lg transition-transform hover:scale-110",children:d.jsx("svg",{viewBox:"0 0 24 24",className:"h-5 w-5 fill-current",children:d.jsx("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 1.74.5 3.37 1.41 4.84.95 1.54 2.2 2.86 3.16 4.4.47.75.81 1.45 1.17 2.26.26.55.47 1.5 1.26 1.5s1-.95 1.26-1.5c.37-.81.7-1.51 1.17-2.26.96-1.53 2.21-2.86 3.16-4.4C18.5 12.37 19 10.74 19 9c0-3.87-3.13-7-7-7zm0 9.75a2.75 2.75 0 110-5.5 2.75 2.75 0 010 5.5z"})})})},r.id)),n&&n.latitude&&n.longitude&&d.jsx(st,{position:{lat:n.latitude,lng:n.longitude},onCloseClick:()=>o(null),pixelOffset:[0,-45],children:d.jsxs("div",{className:"min-w-[220px] max-w-[280px] p-1 font-[Tajawal]",dir:"rtl",children:[d.jsxs("div",{className:"mb-2 flex items-start justify-between gap-2",children:[d.jsx("h3",{className:"text-sm font-bold leading-tight text-gray-900",children:n.name}),d.jsx("button",{onClick:()=>o(null),className:"shrink-0 rounded p-0.5 text-gray-400 hover:bg-gray-100 hover:text-gray-600",children:d.jsx(ie,{className:"h-3.5 w-3.5"})})]}),n.imam&&d.jsxs("p",{className:"mb-1 text-xs text-gray-600",children:[d.jsx("span",{className:"font-medium",children:"الإمام:"})," ",n.imam]}),d.jsxs("p",{className:"mb-2 text-xs text-gray-500",children:[n.location," · ",n.area]}),d.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[n.audio_sample&&n.imam&&d.jsx(fe,{mosqueId:n.id,mosqueName:n.name,imamName:n.imam,audioSrc:n.audio_sample,className:"h-7 px-2 text-xs"}),n.map_link&&d.jsxs("a",{href:n.map_link,target:"_blank",rel:"noopener noreferrer",className:"inline-flex h-7 items-center gap-1 rounded-full bg-gray-100 px-2.5 text-xs text-gray-700 transition-colors hover:bg-gray-200",children:[d.jsx(pe,{className:"h-3 w-3"}),"قوقل ماب"]})]})]})})]})}function dt({userPosition:t}){const e=F();return l.useEffect(()=>{e&&t&&(e.panTo({lat:t.latitude,lng:t.longitude}),e.setZoom(13))},[e,t]),null}function ft({mosques:t,userPosition:e,onLocateMe:n,isLocating:o}){const r=e?{lat:e.latitude,lng:e.longitude}:ct,s=e?13:11;return d.jsx(Me,{apiKey:lt,children:d.jsxs("div",{className:"relative h-full w-full",children:[d.jsxs(re,{defaultCenter:r,defaultZoom:s,mapId:"mosque-map",gestureHandling:"greedy",disableDefaultUI:!1,zoomControl:!0,mapTypeControl:!1,streetViewControl:!1,fullscreenControl:!1,children:[d.jsx(ut,{mosques:t,userPosition:e}),d.jsx(dt,{userPosition:e})]}),d.jsxs(K,{onClick:n,disabled:o,size:"sm",variant:"secondary",className:"absolute top-4 start-4 z-10 gap-1.5 rounded-full bg-white px-4 shadow-lg hover:bg-gray-50",children:[d.jsx(me,{className:`h-4 w-4 ${o?"animate-pulse":""}`}),"حدد موقعي"]})]})})}function Ot(){const{data:t,isLoading:e}=he(),{position:n,error:o,isLoading:r,requestPosition:s}=ge();return e?d.jsx(ae,{}):d.jsxs(d.Fragment,{children:[d.jsx(le,{children:d.jsx("title",{children:"خريطة المساجد - أئمة التراويح"})}),d.jsxs("div",{className:"relative flex flex-col",style:{height:"calc(100vh - 64px)"},children:[d.jsxs("div",{className:"flex items-center gap-3 bg-white px-4 py-2.5 shadow-sm",children:[d.jsx(K,{asChild:!0,variant:"ghost",size:"icon",className:"h-8 w-8 shrink-0",children:d.jsx(de,{to:"/",children:d.jsx(ce,{className:"h-5 w-5"})})}),d.jsx("h1",{className:"text-sm font-bold",children:"خريطة المساجد"}),d.jsxs("span",{className:"text-xs text-muted-foreground",children:[t?.length??0," مسجد"]})]}),o&&d.jsx("div",{className:"bg-destructive/10 px-4 py-2 text-center text-sm text-destructive",children:o.message}),d.jsx("div",{className:"flex-1",children:d.jsx(ft,{mosques:t??[],userPosition:n,onLocateMe:s,isLocating:r})})]})]})}export{Ot as MapPage};

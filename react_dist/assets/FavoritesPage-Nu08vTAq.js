import{j as e}from"./query-CLJXXnyt.js";import{a as l}from"./sentry-BmFBC7An.js";import{c as _,p as I,u as R,q as T,n as q,H as C,B as x,r as $,A as D,t as A}from"./index-B7gfWGL-.js";import{M as G,S as g,a as N,b as v,c as w,d as o}from"./select-BBCGjmWg.js";import"./checkbox-BKeUI-d9.js";import{e as J}from"./use-mosques-CHm49M2i.js";import{M as F}from"./MosqueGrid-D-QyBb8k.js";import"./textarea-B5o91wq8.js";import"./firebase-app-B16QGRlq.js";import{S as K}from"./share-2-C0CuHnV6.js";import{M as y}from"./youtube-CY2NlXOD.js";import{L as Q}from"./landmark-Ds0CXUhg.js";import{L as B}from"./router-Di6JPJcB.js";import"./ui-vendor-Dbbq2re4.js";import"./AudioButton-DIHVMNWz.js";import"./circle-alert-CdOOUx3X.js";import"./arabic-utils-DbmNOh8M.js";import"./external-link-B3dLlnZJ.js";import"./skeleton-wH4GlXrJ.js";const U=[["path",{d:"M10 5H3",key:"1qgfaw"}],["path",{d:"M12 19H3",key:"yhmn1j"}],["path",{d:"M14 3v4",key:"1sua03"}],["path",{d:"M16 17v4",key:"1q0r14"}],["path",{d:"M21 12h-9",key:"1o4lsq"}],["path",{d:"M21 19h-5",key:"1rlt1p"}],["path",{d:"M21 5h-7",key:"1oszz2"}],["path",{d:"M8 10v4",key:"tgpxqk"}],["path",{d:"M8 12H3",key:"a7s4jb"}]],W=_("sliders-horizontal",U);function je(){const{isAuthenticated:z,isLoading:H,user:b}=I(),{favorites:M}=R(),{data:h,isLoading:V}=J(),[E,k]=l.useState(!1),[n,u]=l.useState("all"),[c,d]=l.useState("all"),[p,O]=l.useState("recent"),r=l.useMemo(()=>h?M.map(s=>h.find(t=>t.id===s)).filter(Boolean):[],[h,M]),S=l.useMemo(()=>{const s=new Set(r.map(t=>t.area).filter(Boolean));return Array.from(s).sort()},[r]),L=l.useMemo(()=>{const s=n!=="all"?r.filter(i=>i.area===n):r,t=new Set(s.map(i=>i.location).filter(Boolean));return Array.from(t).sort()},[r,n]),j=l.useMemo(()=>{let s=r;return n!=="all"&&(s=s.filter(t=>t.area===n)),c!=="all"&&(s=s.filter(t=>t.location===c)),p==="name"?s=[...s].sort((t,i)=>t.name.localeCompare(i.name,"ar")):s=[...s].reverse(),s},[r,n,c,p]),a=l.useMemo(()=>{const s=new Set(r.map(m=>m.area).filter(Boolean)).size,t=new Set(r.map(m=>m.location).filter(Boolean)).size,i=r.filter(m=>m.audio_sample).length;return{total:r.length,areas:s,locations:t,withAudio:i}},[r]),P=async()=>{if(!b)return;const s=`${window.location.origin}/u/${b.username}`;if(navigator.share)try{await navigator.share({title:"مفضلاتي - أئمة التراويح",url:s});return}catch{}try{await navigator.clipboard.writeText(s),A.success("تم نسخ رابط الملف الشخصي")}catch{const t=document.createElement("input");t.value=s,document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t),A.success("تم نسخ رابط الملف الشخصي")}},f=n!=="all"||c!=="all";return H?e.jsx(T,{}):z?e.jsxs(e.Fragment,{children:[e.jsx(q,{children:e.jsx("title",{children:"المفضلة - أئمة التراويح"})}),e.jsxs("div",{className:"container py-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[e.jsx("h2",{className:"text-xl font-bold",children:"المفضلة"}),a.total>0&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx(x,{asChild:!0,variant:"outline",size:"sm",className:"gap-1.5",children:e.jsxs(B,{to:"/map",children:[e.jsx(G,{className:"h-4 w-4"}),"خريطة"]})}),e.jsxs(x,{variant:"outline",size:"sm",onClick:P,className:"gap-1.5",children:[e.jsx(K,{className:"h-4 w-4"}),"مشاركة"]})]})]}),a.total>0&&e.jsxs("p",{className:"mt-2 text-sm text-muted-foreground",children:[a.total," ",a.total===1?"مسجد":"مساجد",e.jsx("span",{className:"mx-1.5",children:"·"}),a.areas," ",a.areas===1?"منطقة":"مناطق",e.jsx("span",{className:"mx-1.5",children:"·"}),a.locations," ",a.locations===1?"حي":"أحياء",a.withAudio>0&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"mx-1.5",children:"·"}),a.withAudio," بتلاوة صوتية"]})]})]}),a.total>0&&e.jsxs("div",{className:"mb-6 flex flex-wrap items-center gap-3",children:[S.length>1&&e.jsxs(g,{value:n,onValueChange:s=>{u(s),d("all")},children:[e.jsxs(N,{className:"h-9 w-auto min-w-[140px] gap-1.5 bg-white text-sm",children:[e.jsx(y,{className:"h-3.5 w-3.5 shrink-0 text-muted-foreground"}),e.jsx(v,{placeholder:"جميع المناطق"})]}),e.jsxs(w,{children:[e.jsx(o,{value:"all",children:"جميع المناطق"}),S.map(s=>e.jsx(o,{value:s,children:s},s))]})]}),L.length>1&&e.jsxs(g,{value:c,onValueChange:d,children:[e.jsxs(N,{className:"h-9 w-auto min-w-[140px] gap-1.5 bg-white text-sm",children:[e.jsx(y,{className:"h-3.5 w-3.5 shrink-0 text-muted-foreground"}),e.jsx(v,{placeholder:"جميع الأحياء"})]}),e.jsxs(w,{children:[e.jsx(o,{value:"all",children:"جميع الأحياء"}),L.map(s=>e.jsx(o,{value:s,children:s},s))]})]}),e.jsxs(g,{value:p,onValueChange:s=>O(s),children:[e.jsxs(N,{className:"h-9 w-auto min-w-[140px] gap-1.5 bg-white text-sm",children:[e.jsx(W,{className:"h-3.5 w-3.5 shrink-0 text-muted-foreground"}),e.jsx(v,{})]}),e.jsxs(w,{children:[e.jsx(o,{value:"recent",children:"الأحدث"}),e.jsx(o,{value:"name",children:"الاسم"})]})]}),f&&e.jsx("button",{onClick:()=>{u("all"),d("all")},className:"text-xs text-primary hover:underline",children:"إزالة الفلتر"})]}),V?e.jsx(F,{mosques:[],isLoading:!0}):j.length>0?e.jsxs(e.Fragment,{children:[f&&e.jsxs("p",{className:"mb-4 text-sm text-muted-foreground",children:["عرض ",j.length," من ",a.total]}),e.jsx(F,{mosques:j})]}):a.total>0&&f?e.jsxs("div",{className:"flex flex-col items-center gap-4 py-16 text-center",children:[e.jsx("div",{className:"flex h-14 w-14 items-center justify-center rounded-full bg-muted",children:e.jsx(y,{className:"h-7 w-7 text-muted-foreground/50"})}),e.jsx("p",{className:"text-muted-foreground",children:"لا توجد مساجد في هذا الحي"}),e.jsx("button",{onClick:()=>{u("all"),d("all")},className:"text-sm text-primary hover:underline",children:"عرض الكل"})]}):e.jsxs("div",{className:"flex flex-col items-center gap-5 py-20 text-center",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"flex h-20 w-20 items-center justify-center rounded-2xl bg-primary-light",children:e.jsx(Q,{className:"h-10 w-10 text-primary/30"})}),e.jsx("div",{className:"absolute -bottom-1 -start-1 flex h-8 w-8 items-center justify-center rounded-full bg-white shadow-sm",children:e.jsx(C,{className:"h-4 w-4 text-red-400"})})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("p",{className:"text-lg font-medium text-foreground",children:"لم تضف أي مسجد بعد"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"اضغط على القلب في أي مسجد لإضافته هنا"})]}),e.jsx(x,{asChild:!0,variant:"default",className:"mt-2 gap-2",children:e.jsxs(B,{to:"/",children:[e.jsx(D,{className:"h-4 w-4"}),"تصفح المساجد"]})})]})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(q,{children:e.jsx("title",{children:"المفضلة - أئمة التراويح"})}),e.jsxs("div",{className:"container flex flex-col items-center gap-6 py-24 text-center",children:[e.jsx("div",{className:"flex h-20 w-20 items-center justify-center rounded-full bg-primary-light",children:e.jsx(C,{className:"h-10 w-10 text-primary/40"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-xl font-bold text-foreground",children:"سجل دخولك لحفظ مفضلاتك"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"احفظ المساجد المفضلة وتابعها بسهولة"})]}),e.jsx(x,{onClick:()=>k(!0),className:"h-12 px-8 text-base",children:"تسجيل الدخول"})]}),e.jsx($,{open:E,onOpenChange:k})]})}export{je as FavoritesPage};

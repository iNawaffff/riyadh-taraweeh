import{j as e}from"./query-CLJXXnyt.js";import{a as r}from"./sentry-BmFBC7An.js";import{d as z}from"./use-mosques-CHm49M2i.js";import{c as T,s as Y,D as B,d as H,e as L,f as q,B as h,g as U,I as G,L as R,h as V,A as D,i as J,U as E,P as K,j as Q,a as W,k as M,l as P,m as $}from"./index-B7gfWGL-.js";import{C as X,a as A,b as F}from"./checkbox-BKeUI-d9.js";import{T as Z}from"./textarea-B5o91wq8.js";import{S as c}from"./skeleton-wH4GlXrJ.js";import{e as ee,L as S}from"./router-Di6JPJcB.js";import{C as I}from"./circle-alert-CdOOUx3X.js";import{M as se,Y as ae}from"./youtube-CY2NlXOD.js";import{E as re}from"./external-link-B3dLlnZJ.js";import"./ui-vendor-Dbbq2re4.js";import"./firebase-app-B16QGRlq.js";const le=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],te=T("circle-check-big",le);const ie=[["path",{d:"m16.24 7.76-1.804 5.411a2 2 0 0 1-1.265 1.265L7.76 16.24l1.804-5.411a2 2 0 0 1 1.265-1.265z",key:"9ktpf1"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],ce=T("compass",ie);const ne=[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]],de=T("music",ne),oe=[{value:"location",label:"موقع المسجد غير صحيح"},{value:"imam",label:"معلومات الإمام غير محدثة"},{value:"audio",label:"الرابط الصوتي لا يعمل"},{value:"other",label:"أخرى"}];function me({isOpen:C,onClose:i,mosqueId:l,mosqueName:_}){const[n,p]=r.useState([]),[u,f]=r.useState(""),[j,N]=r.useState(""),[g,d]=r.useState(!1),[y,v]=r.useState(!1),[t,o]=r.useState(null),m=r.useCallback((s,a)=>{p(x=>a?[...x,s]:x.filter(k=>k!==s))},[]),w=r.useCallback(async s=>{if(s.preventDefault(),n.length===0){o("يرجى تحديد نوع الخطأ على الأقل");return}d(!0),o(null);try{await Y({mosque_id:l,error_type:n,error_details:u||void 0,reporter_email:j||void 0}),v(!0)}catch{o("حدث خطأ أثناء إرسال البلاغ. الرجاء المحاولة لاحقاً.")}finally{d(!1)}},[l,n,u,j]),b=r.useCallback(()=>{p([]),f(""),N(""),v(!1),o(null),i()},[i]);return e.jsx(B,{open:C,onOpenChange:s=>!s&&b(),children:e.jsx(H,{className:"max-w-md",children:y?e.jsxs("div",{className:"py-8 text-center",children:[e.jsx(te,{className:"mx-auto mb-4 h-12 w-12 text-primary"}),e.jsx(L,{className:"mb-2 text-xl text-primary",children:"تم إرسال البلاغ بنجاح"}),e.jsx(q,{className:"mb-6",children:"شكراً لمساعدتنا في تحسين الموقع"}),e.jsx(h,{onClick:b,className:"bg-primary hover:bg-primary-dark",children:"إغلاق"})]}):e.jsxs(e.Fragment,{children:[e.jsxs(U,{children:[e.jsx(L,{className:"text-destructive",children:"ابلاغ عن خطأ في معلومات المسجد"}),e.jsxs(q,{children:['يرجى تحديد نوع الخطأ وإضافة أي معلومات إضافية عن "',_,'"']})]}),e.jsxs("form",{onSubmit:w,className:"space-y-4",children:[e.jsx("div",{className:"space-y-3",children:oe.map(({value:s,label:a})=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(X,{id:s,checked:n.includes(s),onCheckedChange:x=>m(s,x===!0)}),e.jsx("label",{htmlFor:s,className:"cursor-pointer text-sm leading-none",children:a})]},s))}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"error_details",className:"text-sm font-medium",children:"تفاصيل إضافية:"}),e.jsx(Z,{id:"error_details",value:u,onChange:s=>f(s.target.value),rows:3,placeholder:"أضف أي تفاصيل إضافية هنا..."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"reporter_email",className:"text-sm font-medium",children:"البريد الإلكتروني (اختياري):"}),e.jsx(G,{id:"reporter_email",type:"email",value:j,onChange:s=>N(s.target.value),placeholder:"example@email.com",dir:"ltr"})]}),t&&e.jsx("p",{className:"text-sm text-destructive",children:t}),e.jsx("div",{className:"pt-2",children:e.jsx(h,{type:"submit",disabled:g,className:"w-full bg-destructive hover:bg-destructive/90",children:g?e.jsxs(e.Fragment,{children:[e.jsx(R,{className:"me-2 h-4 w-4 animate-spin"}),"جاري الإرسال..."]}):"إرسال البلاغ"})})]})]})})})}function _e(){const{id:C}=ee(),i=parseInt(C??"0",10),{data:l,isLoading:_,isError:n}=z(i),{currentTrack:p,isPlaying:u,isLoading:f,play:j}=V(),[N,g]=r.useState(!1),d=p?.mosqueId===i&&u,y=p?.mosqueId===i&&f,v=()=>{l?.audio_sample&&j({mosqueId:i,mosqueName:l.name,imamName:l.imam??"غير محدد",audioSrc:l.audio_sample})};if(_)return e.jsx(xe,{});if(n||!l)return e.jsxs("div",{className:"container py-12 text-center",children:[e.jsx(I,{className:"mx-auto mb-4 h-12 w-12 text-destructive"}),e.jsx("h2",{className:"mb-2 text-xl font-bold text-destructive",children:"حدث خطأ أثناء تحميل بيانات المسجد"}),e.jsx("p",{className:"mb-6 text-muted-foreground",children:"الرجاء المحاولة لاحقاً أو العودة للقائمة الرئيسية"}),e.jsx(h,{asChild:!0,children:e.jsxs(S,{to:"/",children:[e.jsx(D,{className:"me-2 h-4 w-4"}),"العودة للرئيسية"]})})]});const{name:t,location:o,area:m,map_link:w,latitude:b,longitude:s,imam:a,audio_sample:x,youtube_link:k}=l,O=a?`مسجد ${t} هو أحد المساجد المميزة في منطقة ${m} بالرياض، يقود صلاة التراويح فيه ${a} خلال رمضان ١٤٤٦. يتميز المسجد بموقعه المناسب وسهولة الوصول إليه للمصلين الراغبين بالاستماع لتلاوة متميزة.`:`مسجد ${t} هو أحد المساجد المميزة في منطقة ${m} بمدينة الرياض، يُقام فيه صلاة التراويح والقيام خلال شهر رمضان المبارك. يعتبر من الوجهات المفضلة للمصلين خلال ليالي الشهر الفضيل.`;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative overflow-hidden bg-gradient-to-br from-primary to-primary-dark py-10 text-white",children:[e.jsx("div",{className:"islamic-pattern-large absolute inset-0"}),e.jsxs("div",{className:"container relative",children:[e.jsxs("h1",{className:"flex items-center gap-3 text-2xl font-bold md:text-3xl",children:[e.jsx(J,{className:"h-7 w-7 text-accent-light","aria-hidden":"true"}),t]}),a&&e.jsxs("p",{className:"mt-2 text-lg text-white/80",children:[e.jsx(E,{className:"me-1.5 inline h-4 w-4"}),a]}),e.jsx("span",{className:"mt-3 inline-block rounded-full bg-white/15 px-3 py-1 text-sm backdrop-blur-sm",children:m})]})]}),e.jsxs("div",{className:"container py-6",children:[e.jsx("nav",{className:"mb-4","aria-label":"مسار التنقل",children:e.jsxs("ol",{className:"flex flex-wrap items-center gap-2 text-sm",children:[e.jsx("li",{children:e.jsx(S,{to:"/",className:"text-primary transition-colors hover:text-accent hover:underline",children:"الرئيسية"})}),e.jsx("li",{className:"text-muted-foreground",children:">"}),e.jsx("li",{className:"text-muted-foreground",children:t})]})}),e.jsx(A,{className:"border-0 shadow-card",children:e.jsxs(F,{className:"p-6",children:[e.jsx("div",{className:"mb-6 rounded-lg border-e-[3px] border-accent bg-primary-light p-5 leading-relaxed",children:e.jsx("p",{className:"text-justify text-foreground",children:O})}),e.jsxs("section",{className:"mb-6",children:[e.jsx("h2",{className:"mb-4 border-b-2 border-accent pb-2 text-lg font-bold text-primary",children:"معلومات المسجد"}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"flex flex-col rounded-lg border border-primary/10 bg-primary-light/50 p-4",children:[e.jsxs("span",{className:"mb-1 flex items-center gap-2 font-bold text-primary",children:[e.jsx(se,{className:"h-4 w-4"}),"الموقع:"]}),e.jsx("span",{className:"break-words",children:o})]}),e.jsxs("div",{className:"flex flex-col rounded-lg border border-primary/10 bg-primary-light/50 p-4",children:[e.jsxs("span",{className:"mb-1 flex items-center gap-2 font-bold text-primary",children:[e.jsx(ce,{className:"h-4 w-4"}),"المنطقة:"]}),e.jsx("span",{children:m})]}),a&&e.jsxs("div",{className:"flex flex-col rounded-lg border border-primary/10 bg-primary-light/50 p-4 md:col-span-2",children:[e.jsxs("span",{className:"mb-1 flex items-center gap-2 font-bold text-primary",children:[e.jsx(E,{className:"h-4 w-4"}),"إمام التراويح:"]}),e.jsx("span",{children:a})]})]}),x&&e.jsx("div",{className:"mt-4 overflow-hidden rounded-lg border border-accent/20 bg-gradient-to-l from-accent/5 to-primary-light/50 p-5",children:e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-accent/15",children:e.jsx(de,{className:"h-5 w-5 text-accent"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-primary",children:"استمع للتلاوة"}),a&&e.jsx("p",{className:"text-sm text-muted-foreground",children:a})]})]}),e.jsxs(h,{onClick:v,disabled:y,className:W("gap-2 rounded-full px-6",d?"bg-primary-dark text-white":"bg-primary text-white hover:bg-primary-dark"),children:[y?e.jsx(R,{className:"h-5 w-5 animate-spin"}):d?e.jsx(K,{className:"h-5 w-5"}):e.jsx(Q,{className:"h-5 w-5"}),d?"إيقاف":"تشغيل"]})]})}),e.jsxs("div",{className:"mt-5 flex flex-wrap justify-center gap-3 md:justify-start",children:[w&&e.jsxs(M,{children:[e.jsx(P,{asChild:!0,children:e.jsx(h,{variant:"outline",asChild:!0,className:"gap-2 rounded-full border-primary bg-primary-light text-primary hover:bg-primary hover:text-white",children:e.jsxs("a",{href:w,target:"_blank",rel:"noopener noreferrer",children:[e.jsx(re,{className:"h-4 w-4"}),"الاتجاهات في خرائط Google"]})})}),e.jsx($,{children:e.jsx("p",{children:"فتح الموقع في خرائط قوقل"})})]}),k&&e.jsxs(M,{children:[e.jsx(P,{asChild:!0,children:e.jsx(h,{asChild:!0,className:"gap-2 rounded-full bg-youtube text-white hover:bg-youtube-dark",children:e.jsxs("a",{href:k,target:"_blank",rel:"noopener noreferrer",children:[e.jsx(ae,{className:"h-4 w-4"}),"مشاهدة على YouTube"]})})}),e.jsx($,{children:e.jsx("p",{children:"شاهد على يوتيوب"})})]})]})]}),b&&s&&e.jsxs("section",{className:"mb-6",children:[e.jsx("h2",{className:"mb-4 border-b-2 border-accent pb-2 text-lg font-bold text-primary",children:"الموقع على الخريطة"}),e.jsx("div",{className:"relative aspect-video overflow-hidden rounded-xl border border-border shadow-card",children:e.jsx("iframe",{width:"100%",height:"100%",style:{border:0},loading:"lazy",referrerPolicy:"no-referrer-when-downgrade",title:`خريطة ${t}`,src:`https://maps.google.com/maps?q=${b},${s}&z=15&output=embed`,className:"absolute inset-0"})})]}),e.jsxs("div",{className:"mt-8 flex flex-wrap items-center justify-center gap-4",children:[e.jsxs(S,{to:"/",className:"inline-flex items-center gap-2 rounded-full bg-primary-light px-5 py-2.5 font-medium text-primary transition-all hover:bg-primary hover:text-white",children:[e.jsx(D,{className:"h-4 w-4"}),"العودة إلى قائمة المساجد"]}),e.jsxs("button",{onClick:()=>g(!0),className:"inline-flex items-center gap-1.5 rounded-full px-4 py-2 text-sm text-muted-foreground transition-colors hover:bg-destructive/5 hover:text-destructive",children:[e.jsx(I,{className:"h-3.5 w-3.5"}),"ابلاغ عن خطأ"]})]})]})})]}),e.jsx(me,{isOpen:N,onClose:()=>g(!1),mosqueId:i,mosqueName:t})]})}function xe(){return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-gradient-to-br from-primary to-primary-dark py-10",children:e.jsx("div",{className:"container",children:e.jsx(c,{className:"h-9 w-64 bg-white/20"})})}),e.jsx("div",{className:"container py-6",children:e.jsx(A,{className:"border-0 shadow-card",children:e.jsxs(F,{className:"p-6",children:[e.jsx(c,{className:"mb-6 h-32 w-full"}),e.jsx(c,{className:"mb-4 h-6 w-32"}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsx(c,{className:"h-20"}),e.jsx(c,{className:"h-20"}),e.jsx(c,{className:"h-20 md:col-span-2"})]}),e.jsxs("div",{className:"mt-5 flex gap-3",children:[e.jsx(c,{className:"h-10 w-40"}),e.jsx(c,{className:"h-10 w-40"})]})]})})})]})}export{_e as MosqueDetailPage};
